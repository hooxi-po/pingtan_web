<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>百度地图 JavaScript API GL - 平潭旅游</title>
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0px; padding: 0px }
        #container { height: 100% }
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 300px;
        }
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }
        .control-btn {
            display: block;
            margin-bottom: 5px;
            padding: 8px 12px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .control-btn:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>平潭旅游地图 - JavaScript API GL</h3>
        <p>📍 当前位置: 平潭综合实验区</p>
        <p>🗺️ 支持鼠标滚轮缩放</p>
        <p>🔄 支持地图旋转和倾斜</p>
        <p>📌 使用GCJ02坐标系</p>
    </div>
    
    <div class="controls">
        <button class="control-btn" onclick="resetView()">重置视图</button>
        <button class="control-btn" onclick="setRotation()">设置旋转</button>
        <button class="control-btn" onclick="setTilt()">设置倾斜</button>
        <button class="control-btn" onclick="addMarker()">添加标记</button>
    </div>
    
    <div id="container"></div>
    
    <!-- 引入百度地图JavaScript API GL文件 -->
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=06qDlqkPqwlkV2EpRWA4zuNixE8QNRHs"></script>
    
    <script type="text/javascript">
        // 设置GCJ02坐标系（需要在初始化地图前配置）
        BMapGL.coordType = BMAP_COORD_GCJ02;
        
        // 创建地图实例
        var map = new BMapGL.Map("container", {
            coordType: BMAP_COORD_GCJ02,
            enableIconClick: true,
            enableRotate: true,
            enableTilt: true
        });
        
        // 平潭的坐标点 (平潭综合实验区)
        var pingtanPoint = new BMapGL.Point(119.790, 25.503);
        
        // 初始化地图，设置中心点坐标和地图级别
        map.centerAndZoom(pingtanPoint, 15);
        
        // 开启鼠标滚轮缩放
        map.enableScrollWheelZoom();
        
        // 设置地图的旋转角度和倾斜角度
        map.setHeading(0);   // 设置地图旋转角度
        map.setTilt(0);      // 设置地图的倾斜角度
        
        // 添加平潭主要景点标记
        var mainMarker = new BMapGL.Marker(pingtanPoint, {
            coordType: BMAP_COORD_GCJ02
        });
        map.addOverlay(mainMarker);
        
        // 添加信息窗口
        var infoWindow = new BMapGL.InfoWindow(
            "<div style='padding:10px;'>" +
            "<h4>平潭综合实验区</h4>" +
            "<p>福建省平潭县，美丽的海岛旅游胜地</p>" +
            "<p>经度: 119.790, 纬度: 25.503</p>" +
            "</div>", {
                width: 250,
                height: 100
            }
        );
        
        mainMarker.addEventListener('click', function(){
            map.openInfoWindow(infoWindow, pingtanPoint, {
                coordType: BMAP_COORD_GCJ02
            });
        });
        
        // 添加控件
        var zoomControl = new BMapGL.ZoomControl({
            anchor: BMAP_ANCHOR_BOTTOM_RIGHT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(zoomControl);
        
        var scaleControl = new BMapGL.ScaleControl({
            anchor: BMAP_ANCHOR_BOTTOM_LEFT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(scaleControl);
        
        // 控制函数
        function resetView() {
            map.centerAndZoom(pingtanPoint, 15);
            map.setHeading(0);
            map.setTilt(0);
        }
        
        function setRotation() {
            map.setHeading(64.5);  // 设置地图旋转角度
        }
        
        function setTilt() {
            map.setTilt(73);       // 设置地图的倾斜角度
        }
        
        function addMarker() {
            // 在平潭附近添加随机标记点
            var randomLng = 119.790 + (Math.random() - 0.5) * 0.1;
            var randomLat = 25.503 + (Math.random() - 0.5) * 0.1;
            var randomPoint = new BMapGL.Point(randomLng, randomLat);
            
            var randomMarker = new BMapGL.Marker(randomPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(randomMarker);
            
            var randomInfoWindow = new BMapGL.InfoWindow(
                "<div style='padding:10px;'>" +
                "<h4>随机景点</h4>" +
                "<p>经度: " + randomLng.toFixed(6) + "</p>" +
                "<p>纬度: " + randomLat.toFixed(6) + "</p>" +
                "</div>", {
                    width: 200,
                    height: 80
                }
            );
            
            randomMarker.addEventListener('click', function(){
                map.openInfoWindow(randomInfoWindow, randomPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        }
        
        console.log('百度地图JavaScript API GL初始化完成 - 平潭旅游地图');
    </script>
</body>
</html>