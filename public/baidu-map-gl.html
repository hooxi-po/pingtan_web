<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ç™¾åº¦åœ°å›¾ JavaScript API GL - å¹³æ½­æ—…æ¸¸</title>
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0px; padding: 0px }
        #container { height: 100% }
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 300px;
        }
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }
        .control-btn {
            display: block;
            margin-bottom: 5px;
            padding: 8px 12px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .control-btn:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>å¹³æ½­æ—…æ¸¸åœ°å›¾ - JavaScript API GL</h3>
        <p>ğŸ“ å½“å‰ä½ç½®: å¹³æ½­ç»¼åˆå®éªŒåŒº</p>
        <p>ğŸ—ºï¸ æ”¯æŒé¼ æ ‡æ»šè½®ç¼©æ”¾</p>
        <p>ğŸ”„ æ”¯æŒåœ°å›¾æ—‹è½¬å’Œå€¾æ–œ</p>
        <p>ğŸ“Œ ä½¿ç”¨GCJ02åæ ‡ç³»</p>
    </div>
    
    <div class="controls">
        <button class="control-btn" onclick="resetView()">é‡ç½®è§†å›¾</button>
        <button class="control-btn" onclick="setRotation()">è®¾ç½®æ—‹è½¬</button>
        <button class="control-btn" onclick="setTilt()">è®¾ç½®å€¾æ–œ</button>
        <button class="control-btn" onclick="addMarker()">æ·»åŠ æ ‡è®°</button>
    </div>
    
    <div id="container"></div>
    
    <!-- å¼•å…¥ç™¾åº¦åœ°å›¾JavaScript API GLæ–‡ä»¶ -->
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=06qDlqkPqwlkV2EpRWA4zuNixE8QNRHs"></script>
    
    <script type="text/javascript">
        // è®¾ç½®GCJ02åæ ‡ç³»ï¼ˆéœ€è¦åœ¨åˆå§‹åŒ–åœ°å›¾å‰é…ç½®ï¼‰
        BMapGL.coordType = BMAP_COORD_GCJ02;
        
        // åˆ›å»ºåœ°å›¾å®ä¾‹
        var map = new BMapGL.Map("container", {
            coordType: BMAP_COORD_GCJ02,
            enableIconClick: true,
            enableRotate: true,
            enableTilt: true
        });
        
        // å¹³æ½­çš„åæ ‡ç‚¹ (å¹³æ½­ç»¼åˆå®éªŒåŒº)
        var pingtanPoint = new BMapGL.Point(119.790, 25.503);
        
        // åˆå§‹åŒ–åœ°å›¾ï¼Œè®¾ç½®ä¸­å¿ƒç‚¹åæ ‡å’Œåœ°å›¾çº§åˆ«
        map.centerAndZoom(pingtanPoint, 15);
        
        // å¼€å¯é¼ æ ‡æ»šè½®ç¼©æ”¾
        map.enableScrollWheelZoom();
        
        // è®¾ç½®åœ°å›¾çš„æ—‹è½¬è§’åº¦å’Œå€¾æ–œè§’åº¦
        map.setHeading(0);   // è®¾ç½®åœ°å›¾æ—‹è½¬è§’åº¦
        map.setTilt(0);      // è®¾ç½®åœ°å›¾çš„å€¾æ–œè§’åº¦
        
        // æ·»åŠ å¹³æ½­ä¸»è¦æ™¯ç‚¹æ ‡è®°
        var mainMarker = new BMapGL.Marker(pingtanPoint, {
            coordType: BMAP_COORD_GCJ02
        });
        map.addOverlay(mainMarker);
        
        // æ·»åŠ ä¿¡æ¯çª—å£
        var infoWindow = new BMapGL.InfoWindow(
            "<div style='padding:10px;'>" +
            "<h4>å¹³æ½­ç»¼åˆå®éªŒåŒº</h4>" +
            "<p>ç¦å»ºçœå¹³æ½­å¿ï¼Œç¾ä¸½çš„æµ·å²›æ—…æ¸¸èƒœåœ°</p>" +
            "<p>ç»åº¦: 119.790, çº¬åº¦: 25.503</p>" +
            "</div>", {
                width: 250,
                height: 100
            }
        );
        
        mainMarker.addEventListener('click', function(){
            map.openInfoWindow(infoWindow, pingtanPoint, {
                coordType: BMAP_COORD_GCJ02
            });
        });
        
        // æ·»åŠ æ§ä»¶
        var zoomControl = new BMapGL.ZoomControl({
            anchor: BMAP_ANCHOR_BOTTOM_RIGHT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(zoomControl);
        
        var scaleControl = new BMapGL.ScaleControl({
            anchor: BMAP_ANCHOR_BOTTOM_LEFT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(scaleControl);
        
        // æ§åˆ¶å‡½æ•°
        function resetView() {
            map.centerAndZoom(pingtanPoint, 15);
            map.setHeading(0);
            map.setTilt(0);
        }
        
        function setRotation() {
            map.setHeading(64.5);  // è®¾ç½®åœ°å›¾æ—‹è½¬è§’åº¦
        }
        
        function setTilt() {
            map.setTilt(73);       // è®¾ç½®åœ°å›¾çš„å€¾æ–œè§’åº¦
        }
        
        function addMarker() {
            // åœ¨å¹³æ½­é™„è¿‘æ·»åŠ éšæœºæ ‡è®°ç‚¹
            var randomLng = 119.790 + (Math.random() - 0.5) * 0.1;
            var randomLat = 25.503 + (Math.random() - 0.5) * 0.1;
            var randomPoint = new BMapGL.Point(randomLng, randomLat);
            
            var randomMarker = new BMapGL.Marker(randomPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(randomMarker);
            
            var randomInfoWindow = new BMapGL.InfoWindow(
                "<div style='padding:10px;'>" +
                "<h4>éšæœºæ™¯ç‚¹</h4>" +
                "<p>ç»åº¦: " + randomLng.toFixed(6) + "</p>" +
                "<p>çº¬åº¦: " + randomLat.toFixed(6) + "</p>" +
                "</div>", {
                    width: 200,
                    height: 80
                }
            );
            
            randomMarker.addEventListener('click', function(){
                map.openInfoWindow(randomInfoWindow, randomPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        }
        
        console.log('ç™¾åº¦åœ°å›¾JavaScript API GLåˆå§‹åŒ–å®Œæˆ - å¹³æ½­æ—…æ¸¸åœ°å›¾');
    </script>
</body>
</html>