<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ç™¾åº¦åœ°å›¾ - å¹³æ½­æ—…æ¸¸</title>
    <style type="text/css">
        html{height:100%}
        body{height:100%;margin:0px;padding:0px;font-family: Arial, sans-serif;}
        #container{height:100%}
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 300px;
        }
        .info-panel h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .info-panel p {
            margin: 5px 0;
            color: #666;
            font-size: 14px;
        }
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }
        .control-btn {
            display: block;
            margin: 5px 0;
            padding: 8px 12px;
            background: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .control-btn:hover {
            background: #3367d6;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>å¹³æ½­æ—…æ¸¸åœ°å›¾</h3>
        <p>ğŸ“ å½“å‰ä½ç½®: å¹³æ½­ç»¼åˆå®éªŒåŒº</p>
        <p>ğŸ—ºï¸ æ”¯æŒé¼ æ ‡æ»šè½®ç¼©æ”¾</p>
        <p>ğŸ”„ æ”¯æŒåœ°å›¾æ—‹è½¬å’Œå€¾æ–œ</p>
        <p>ğŸ“Œ ç‚¹å‡»åœ°å›¾æ·»åŠ æ ‡è®°ç‚¹</p>
    </div>
    
    <div class="controls">
        <button class="control-btn" onclick="resetView()">é‡ç½®è§†å›¾</button>
        <button class="control-btn" onclick="toggleRotate()">åˆ‡æ¢æ—‹è½¬</button>
        <button class="control-btn" onclick="addRandomMarker()">æ·»åŠ æ ‡è®°</button>
        <button class="control-btn" onclick="clearMarkers()">æ¸…é™¤æ ‡è®°</button>
    </div>
    
    <div id="container"></div>
    
    <!-- å¼•å…¥ç™¾åº¦åœ°å›¾APIæ–‡ä»¶ -->
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=06qDlqkPqwlkV2EpRWA4zuNixE8QNRHs"></script>
    
    <script type="text/javascript">
        // è®¾ç½®åæ ‡ç±»å‹ä¸ºGCJ02
        BMapGL.coordType = BMAP_COORD_GCJ02;
        
        // åˆ›å»ºåœ°å›¾å®ä¾‹
        var map = new BMapGL.Map("container", {
            coordType: BMAP_COORD_GCJ02,
            enableIconClick: true,
            enableRotate: true,
            enableTilt: true
        });
        
        // å¹³æ½­çš„åæ ‡ç‚¹ (å¹³æ½­ç»¼åˆå®éªŒåŒº)
        var pingtanPoint = new BMapGL.Point(119.790, 25.503);
        
        // åˆå§‹åŒ–åœ°å›¾ï¼Œè®¾ç½®ä¸­å¿ƒç‚¹åæ ‡å’Œåœ°å›¾çº§åˆ«
        map.centerAndZoom(pingtanPoint, 12);
        
        // å¼€å¯é¼ æ ‡æ»šè½®ç¼©æ”¾
        map.enableScrollWheelZoom();
        
        // è®¾ç½®åœ°å›¾çš„æ—‹è½¬è§’åº¦å’Œå€¾æ–œè§’åº¦
        map.setHeading(0);   // è®¾ç½®åœ°å›¾æ—‹è½¬è§’åº¦
        map.setTilt(45);     // è®¾ç½®åœ°å›¾çš„å€¾æ–œè§’åº¦
        
        // å­˜å‚¨æ ‡è®°ç‚¹çš„æ•°ç»„
        var markers = [];
        
        // åœ¨å¹³æ½­æ·»åŠ ä¸€ä¸ªæ ‡è®°ç‚¹
        var pingtanMarker = new BMapGL.Marker(pingtanPoint, {
            coordType: BMAP_COORD_GCJ02
        });
        map.addOverlay(pingtanMarker);
        markers.push(pingtanMarker);
        
        // åˆ›å»ºä¿¡æ¯çª—å£
        var infoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>å¹³æ½­ç»¼åˆå®éªŒåŒº</h4><p>ç¦å»ºçœå¹³æ½­ç»¼åˆå®éªŒåŒºï¼Œç¾ä¸½çš„æµ·å²›æ—…æ¸¸èƒœåœ°</p><p>ğŸ–ï¸ æµ·æ»©é£å…‰ | ğŸ›ï¸ å†å²æ–‡åŒ– | ğŸ¤ æµ·é²œç¾é£Ÿ</p></div>", {
            width: 250,
            height: 120
        });
        
        // æ ‡è®°ç‚¹ç‚¹å‡»äº‹ä»¶
        pingtanMarker.addEventListener('click', function(){
            map.openInfoWindow(infoWindow, pingtanPoint, {
                coordType: BMAP_COORD_GCJ02
            });
        });
        
        // åœ°å›¾ç‚¹å‡»äº‹ä»¶ - æ·»åŠ æ ‡è®°ç‚¹
        map.addEventListener('click', function(e){
            var clickPoint = new BMapGL.Point(e.latlng.lng, e.latlng.lat);
            var newMarker = new BMapGL.Marker(clickPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(newMarker);
            markers.push(newMarker);
            
            // ä¸ºæ–°æ ‡è®°ç‚¹æ·»åŠ ä¿¡æ¯çª—å£
            var clickInfoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>æ–°æ ‡è®°ç‚¹</h4><p>ç»åº¦: " + e.latlng.lng.toFixed(6) + "</p><p>çº¬åº¦: " + e.latlng.lat.toFixed(6) + "</p></div>", {
                width: 200,
                height: 80
            });
            
            newMarker.addEventListener('click', function(){
                map.openInfoWindow(clickInfoWindow, clickPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        });
        
        // æ§åˆ¶å‡½æ•°
        var rotateEnabled = true;
        
        function resetView() {
            map.centerAndZoom(pingtanPoint, 12);
            map.setHeading(0);
            map.setTilt(45);
        }
        
        function toggleRotate() {
            rotateEnabled = !rotateEnabled;
            if (rotateEnabled) {
                map.setHeading(64.5);
                map.setTilt(73);
            } else {
                map.setHeading(0);
                map.setTilt(0);
            }
        }
        
        function addRandomMarker() {
            // åœ¨å¹³æ½­å‘¨å›´éšæœºæ·»åŠ æ ‡è®°ç‚¹
            var randomLng = 119.790 + (Math.random() - 0.5) * 0.1;
            var randomLat = 25.503 + (Math.random() - 0.5) * 0.1;
            var randomPoint = new BMapGL.Point(randomLng, randomLat);
            
            var randomMarker = new BMapGL.Marker(randomPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(randomMarker);
            markers.push(randomMarker);
            
            var randomInfoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>éšæœºæ™¯ç‚¹</h4><p>ç»åº¦: " + randomLng.toFixed(6) + "</p><p>çº¬åº¦: " + randomLat.toFixed(6) + "</p></div>", {
                width: 200,
                height: 80
            });
            
            randomMarker.addEventListener('click', function(){
                map.openInfoWindow(randomInfoWindow, randomPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        }
        
        function clearMarkers() {
            // æ¸…é™¤é™¤äº†å¹³æ½­ä¸»æ ‡è®°ç‚¹å¤–çš„æ‰€æœ‰æ ‡è®°
            for (var i = 1; i < markers.length; i++) {
                map.removeOverlay(markers[i]);
            }
            markers = [markers[0]]; // åªä¿ç•™ç¬¬ä¸€ä¸ªæ ‡è®°ç‚¹
        }
        
        // æ·»åŠ åœ°å›¾ç±»å‹æ§ä»¶
        var mapTypeControl = new BMapGL.MapTypeControl({
            anchor: BMAP_ANCHOR_TOP_LEFT,
            offset: new BMapGL.Size(10, 120)
        });
        map.addControl(mapTypeControl);
        
        // æ·»åŠ ç¼©æ”¾æ§ä»¶
        var zoomControl = new BMapGL.ZoomControl({
            anchor: BMAP_ANCHOR_BOTTOM_RIGHT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(zoomControl);
        
        // æ·»åŠ æ¯”ä¾‹å°ºæ§ä»¶
        var scaleControl = new BMapGL.ScaleControl({
            anchor: BMAP_ANCHOR_BOTTOM_LEFT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(scaleControl);
        
        console.log('ç™¾åº¦åœ°å›¾åˆå§‹åŒ–å®Œæˆ - å¹³æ½­æ—…æ¸¸åœ°å›¾');
    </script>
</body>
</html>