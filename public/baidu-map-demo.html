<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>百度地图 - 平潭旅游</title>
    <style type="text/css">
        html{height:100%}
        body{height:100%;margin:0px;padding:0px;font-family: Arial, sans-serif;}
        #container{height:100%}
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 300px;
        }
        .info-panel h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .info-panel p {
            margin: 5px 0;
            color: #666;
            font-size: 14px;
        }
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }
        .control-btn {
            display: block;
            margin: 5px 0;
            padding: 8px 12px;
            background: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .control-btn:hover {
            background: #3367d6;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>平潭旅游地图</h3>
        <p>📍 当前位置: 平潭综合实验区</p>
        <p>🗺️ 支持鼠标滚轮缩放</p>
        <p>🔄 支持地图旋转和倾斜</p>
        <p>📌 点击地图添加标记点</p>
    </div>
    
    <div class="controls">
        <button class="control-btn" onclick="resetView()">重置视图</button>
        <button class="control-btn" onclick="toggleRotate()">切换旋转</button>
        <button class="control-btn" onclick="addRandomMarker()">添加标记</button>
        <button class="control-btn" onclick="clearMarkers()">清除标记</button>
    </div>
    
    <div id="container"></div>
    
    <!-- 引入百度地图API文件 -->
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=06qDlqkPqwlkV2EpRWA4zuNixE8QNRHs"></script>
    
    <script type="text/javascript">
        // 设置坐标类型为GCJ02
        BMapGL.coordType = BMAP_COORD_GCJ02;
        
        // 创建地图实例
        var map = new BMapGL.Map("container", {
            coordType: BMAP_COORD_GCJ02,
            enableIconClick: true,
            enableRotate: true,
            enableTilt: true
        });
        
        // 平潭的坐标点 (平潭综合实验区)
        var pingtanPoint = new BMapGL.Point(119.790, 25.503);
        
        // 初始化地图，设置中心点坐标和地图级别
        map.centerAndZoom(pingtanPoint, 12);
        
        // 开启鼠标滚轮缩放
        map.enableScrollWheelZoom();
        
        // 设置地图的旋转角度和倾斜角度
        map.setHeading(0);   // 设置地图旋转角度
        map.setTilt(45);     // 设置地图的倾斜角度
        
        // 存储标记点的数组
        var markers = [];
        
        // 在平潭添加一个标记点
        var pingtanMarker = new BMapGL.Marker(pingtanPoint, {
            coordType: BMAP_COORD_GCJ02
        });
        map.addOverlay(pingtanMarker);
        markers.push(pingtanMarker);
        
        // 创建信息窗口
        var infoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>平潭综合实验区</h4><p>福建省平潭综合实验区，美丽的海岛旅游胜地</p><p>🏖️ 海滩风光 | 🏛️ 历史文化 | 🍤 海鲜美食</p></div>", {
            width: 250,
            height: 120
        });
        
        // 标记点点击事件
        pingtanMarker.addEventListener('click', function(){
            map.openInfoWindow(infoWindow, pingtanPoint, {
                coordType: BMAP_COORD_GCJ02
            });
        });
        
        // 地图点击事件 - 添加标记点
        map.addEventListener('click', function(e){
            var clickPoint = new BMapGL.Point(e.latlng.lng, e.latlng.lat);
            var newMarker = new BMapGL.Marker(clickPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(newMarker);
            markers.push(newMarker);
            
            // 为新标记点添加信息窗口
            var clickInfoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>新标记点</h4><p>经度: " + e.latlng.lng.toFixed(6) + "</p><p>纬度: " + e.latlng.lat.toFixed(6) + "</p></div>", {
                width: 200,
                height: 80
            });
            
            newMarker.addEventListener('click', function(){
                map.openInfoWindow(clickInfoWindow, clickPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        });
        
        // 控制函数
        var rotateEnabled = true;
        
        function resetView() {
            map.centerAndZoom(pingtanPoint, 12);
            map.setHeading(0);
            map.setTilt(45);
        }
        
        function toggleRotate() {
            rotateEnabled = !rotateEnabled;
            if (rotateEnabled) {
                map.setHeading(64.5);
                map.setTilt(73);
            } else {
                map.setHeading(0);
                map.setTilt(0);
            }
        }
        
        function addRandomMarker() {
            // 在平潭周围随机添加标记点
            var randomLng = 119.790 + (Math.random() - 0.5) * 0.1;
            var randomLat = 25.503 + (Math.random() - 0.5) * 0.1;
            var randomPoint = new BMapGL.Point(randomLng, randomLat);
            
            var randomMarker = new BMapGL.Marker(randomPoint, {
                coordType: BMAP_COORD_GCJ02
            });
            map.addOverlay(randomMarker);
            markers.push(randomMarker);
            
            var randomInfoWindow = new BMapGL.InfoWindow("<div style='padding:10px;'><h4>随机景点</h4><p>经度: " + randomLng.toFixed(6) + "</p><p>纬度: " + randomLat.toFixed(6) + "</p></div>", {
                width: 200,
                height: 80
            });
            
            randomMarker.addEventListener('click', function(){
                map.openInfoWindow(randomInfoWindow, randomPoint, {
                    coordType: BMAP_COORD_GCJ02
                });
            });
        }
        
        function clearMarkers() {
            // 清除除了平潭主标记点外的所有标记
            for (var i = 1; i < markers.length; i++) {
                map.removeOverlay(markers[i]);
            }
            markers = [markers[0]]; // 只保留第一个标记点
        }
        
        // 添加地图类型控件
        var mapTypeControl = new BMapGL.MapTypeControl({
            anchor: BMAP_ANCHOR_TOP_LEFT,
            offset: new BMapGL.Size(10, 120)
        });
        map.addControl(mapTypeControl);
        
        // 添加缩放控件
        var zoomControl = new BMapGL.ZoomControl({
            anchor: BMAP_ANCHOR_BOTTOM_RIGHT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(zoomControl);
        
        // 添加比例尺控件
        var scaleControl = new BMapGL.ScaleControl({
            anchor: BMAP_ANCHOR_BOTTOM_LEFT,
            offset: new BMapGL.Size(20, 20)
        });
        map.addControl(scaleControl);
        
        console.log('百度地图初始化完成 - 平潭旅游地图');
    </script>
</body>
</html>